<%- include('partials/header', { title: title, currentPage: '', cssFile: 'checkout' }) %>

<div class="container">
    <div class="checkout-header">
        <h1>Checkout</h1>
        <div class="progress-steps">
            <div class="step active">
                <span class="step-number">1</span>
                <span class="step-label">Shipping</span>
            </div>
            <div class="step">
                <span class="step-number">2</span>
                <span class="step-label">Payment</span>
            </div>
            <div class="step">
                <span class="step-number">3</span>
                <span class="step-label">Review</span>
            </div>
        </div>
    </div>

    <div class="checkout-content">
        <div class="checkout-form-section">
            <div class="form-card">
                <h2>Shipping Information</h2>
                <p class="form-subtitle">Enter your delivery address details.</p>
                
                <% if (typeof error !== 'undefined' && error) { %>
                <div class="error-message" style="background: #fee; color: #c33; padding: 12px; border-radius: 6px; margin-bottom: 20px;">
                    <%= error %>
                </div>
                <% } %>
                
                <form class="checkout-form" action="/checkout" method="POST">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="firstName">First Name</label>
                            <input type="text" id="firstName" name="firstName" required>
                        </div>
                        <div class="form-group">
                            <label for="lastName">Last Name</label>
                            <input type="text" id="lastName" name="lastName" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="address">Address</label>
                        <input type="text" id="address" name="address" required>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="city">City</label>
                            <input type="text" id="city" name="city" required>
                        </div>
                        <div class="form-group">
                            <label for="state">State / Province</label>
                            <select id="state" name="state" required>
                                <option value="">Select State</option>
                                <option value="maharashtra">Maharashtra</option>
                                <option value="karnataka">Karnataka</option>
                                <option value="delhi">Delhi</option>
                                <option value="tamilnadu">Tamil Nadu</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="postalCode">Postal Code</label>
                            <input type="text" id="postalCode" name="postalCode" required>
                        </div>
                        <div class="form-group">
                            <label for="country">Country</label>
                            <select id="country" name="country" required>
                                <option value="india">India</option>
                                <option value="usa">United States</option>
                                <option value="uk">United Kingdom</option>
                                <option value="australia">Australia</option>
                            </select>
                        </div>
                    </div>
                    
                    <button type="submit" class="continue-btn">Continue to Payment</button>
                </form>
            </div>
        </div>

        <div class="order-summary-section">
            <div class="summary-card">
                <h2>Order Summary</h2>
                <div class="order-items">
                    <% if (typeof orderItems !== 'undefined' && orderItems.length > 0) { %>
                        <% orderItems.forEach(item => { %>
                        <div class="order-item">
                            <div class="item-image">
                                <% if (isValidUrl(item.image)) { %>
                                    <img src="<%= item.image %>" width="80%" height="80%">
                                <% } else { %>
                                    <%= item.image || 'üèè' %>
                                <% } %>
                            </div>
                            <div class="item-info">
                                <div class="item-name"><%= item.name %></div>
                                <div class="item-qty">Qty: <%= item.quantity || 1 %></div>
                            </div>
                            <div class="item-price">$<%= ((item.price || 0) * (item.quantity || 1)).toFixed(2) %></div>
                        </div>
                        <% }); %>
                    <% } else { %>
                        <div class="order-item">
                            <div class="item-image">üèè</div>
                            <div class="item-info">
                                <div class="item-name">Sample Product</div>
                                <div class="item-qty">Qty: 1</div>
                            </div>
                            <div class="item-price">$0.00</div>
                        </div>
                    <% } %>
                </div>
                
                <div class="price-breakdown">
                    <% 
                        let orderSubtotal = 0;
                        if (typeof orderItems !== 'undefined' && orderItems.length > 0) {
                            orderSubtotal = orderItems.reduce((sum, item) => sum + (item.price || 0) * (item.quantity || 1), 0);
                        }
                        const orderShipping = 10.00;
                        const orderTax = orderSubtotal * 0.01;
                        const orderTotal = orderSubtotal + orderShipping + orderTax;
                    %>
                    <div class="price-row">
                        <span>Subtotal</span>
                        <span>$<%= orderSubtotal.toFixed(2) %></span>
                    </div>
                    <div class="price-row">
                        <span>Shipping</span>
                        <span>$<%= orderShipping.toFixed(2) %></span>
                    </div>
                    <div class="price-row">
                        <span>Tax</span>
                        <span>$<%= orderTax.toFixed(2) %></span>
                    </div>
                </div>
                
                <div class="order-total">
                    <span>Total</span>
                    <span>$<%= orderTotal.toFixed(2) %></span>
                </div>
                
                <p class="tax-note">Prices are inclusive of all applicable taxes.</p>
            </div>
        </div>
    </div>
</div>

<%- include('partials/footer') %>

